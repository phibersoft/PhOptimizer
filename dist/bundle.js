#!/usr/bin/env node
(()=>{"use strict";var e={877:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.colored=void 0,t.colored=(e,t="info")=>`${{info:"[36m",error:"[31m",success:"[32m"}[t]}${e}[0m`},915:function(e,t,o){var i=this&&this.__createBinding||(Object.create?function(e,t,o,i){void 0===i&&(i=o);var n=Object.getOwnPropertyDescriptor(t,o);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,i,n)}:function(e,t,o,i){void 0===i&&(i=o),e[i]=t[o]}),n=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||i(t,e,o)};Object.defineProperty(t,"__esModule",{value:!0}),n(o(877),t),n(o(162),t),n(o(214),t)},162:function(e,t,o){var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))((function(n,r){function a(e){try{s(i.next(e))}catch(e){r(e)}}function c(e){try{s(i.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,c)}s((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.optimizer=void 0;const n=o(12);t.optimizer=(e,t,o,r,a=n.AUTO,c=80)=>i(void 0,void 0,void 0,(function*(){const i=`${e}\\${t}`,s=yield(0,n.read)(i);if(yield s.contain(r,a),yield s.quality(c),o)yield s.writeAsync(i);else{const o=t.split("."),i=o.slice(0,o.length-1).join("."),n=o[o.length-1];yield s.writeAsync(`${e}\\${i}-optimized.${n}`)}}))},214:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=o(877);process.on("uncaughtException",((e,t)=>{console.log((0,i.colored)(e.message,"error")),console.log((0,i.colored)(t,"error"))}))},519:function(e,t,o){var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))((function(n,r){function a(e){try{s(i.next(e))}catch(e){r(e)}}function c(e){try{s(i.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,c)}s((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),o(214);const n=o(12),r=o(515),a=o(521),c=o(147),s=o(915),l=new r.ArgumentParser({description:"Phoptimizator is a simple image optimizator from -cli."}),u=(0,a.createInterface)({input:process.stdin,output:process.stdout}),d=["jpg","jpeg","png","tif","gif","bmp"];l.add_argument("-v","--version",{action:"version",version:o(598).i8}),l.add_argument("-f","--file",{help:"Image name on current path. Example: xxx.jpg",default:"ALL"}),l.add_argument("-p","--path",{help:"Image path destination. Default: process.cwd()",default:process.cwd()}),l.add_argument("-q","--quality",{help:"Image quality. Default: 70",default:70}),l.add_argument("-he","--height",{help:"Image height. Default: AUTO",default:n.AUTO}),l.add_argument("-w","--width",{help:"Image width. Default: 1920",default:1920}),l.add_argument("-o","--overwrite",{help:"Overwrite. If you set this option, optimized image overwrites original file with same name.",default:!1});const p=l.parse_args();i(void 0,void 0,void 0,(function*(){const e=Object.keys(p).reduce(((e,t)=>e+`${t}: ${p[t]}\n`),"Options: \n")+"\nAre you sure you want to continue? (y/n)";u.question(e,(e=>i(void 0,void 0,void 0,(function*(){if("y"===e.toLowerCase()){let e=[];"ALL"===p.file?(e=(yield c.promises.readdir(p.path)).filter((e=>{const t=e.split("."),o=t[t.length-1];return d.includes(o)})),console.log(e)):e.push(p.file);for(let t=0;t<e.length;t++){const o=e[t];console.log((0,s.colored)(`Optimizing ${o}... [${t+1}/${e.length}]`,"info")),yield(0,s.optimizer)(p.path,o,p.overwrite,p.width,p.height,p.quality)}console.log((0,s.colored)("Optimization completed!","success")),process.exit(5)}else console.log((0,s.colored)("Optimization canceled!","error")),process.exit(13)}))))}))},515:e=>{e.exports=require("argparse")},12:e=>{e.exports=require("jimp")},147:e=>{e.exports=require("fs")},521:e=>{e.exports=require("readline")},598:e=>{e.exports={i8:"2.5.5"}}},t={};!function o(i){var n=t[i];if(void 0!==n)return n.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,o),r.exports}(519)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LElBQUFqQixXQUNKMEMsRUFBUXpDLEtBQ1JxRCxFQUNBWixFQUFRdkMsVUFDUnVDLEVBQVF0QyxNQUNSc0MsRUFBUXJDLE9BQ1JxQyxFQUFRbkMsUSxDQUlaaUIsUUFBUUMsS0FBSSxJQUFBL0IsU0FBUSwwQkFBMkIsWUFDL0MwQixRQUFRNEMsS0FBSyxFLE1BRWJ4QyxRQUFRQyxLQUFJLElBQUEvQixTQUFRLHlCQUEwQixVQUM5QzBCLFFBQVE0QyxLQUFLLEdBRWpCLEtBQ0YsRyxVQ3BHQUMsRUFBT0MsUUFBVUMsUUFBUSxXLFNDQXpCRixFQUFPQyxRQUFVQyxRQUFRLE8sVUNBekJGLEVBQU9DLFFBQVVDLFFBQVEsSyxVQ0F6QkYsRUFBT0MsUUFBVUMsUUFBUSxXLG1DQ0NyQkMsRUFBMkIsQ0FBQyxHQUdoQyxTQUFTQyxFQUFvQkMsR0FFNUIsSUFBSUMsRUFBZUgsRUFBeUJFLEdBQzVDLFFBQXFCRSxJQUFqQkQsRUFDSCxPQUFPQSxFQUFhTCxRQUdyQixJQUFJRCxFQUFTRyxFQUF5QkUsR0FBWSxDQUdqREosUUFBUyxDQUFDLEdBT1gsT0FIQU8sRUFBb0JILEdBQVVJLEtBQUtULEVBQU9DLFFBQVNELEVBQVFBLEVBQU9DLFFBQVNHLEdBR3BFSixFQUFPQyxPQUNmLENDbkIwQkcsQ0FBb0IsSSIsInNvdXJjZXMiOlsid2VicGFjazovL3Bob3B0aW1pemVyLy4vc3JjL2xpYi9jb2xvcmVkLnRzIiwid2VicGFjazovL3Bob3B0aW1pemVyLy4vc3JjL2xpYi9pbmRleC50cyIsIndlYnBhY2s6Ly9waG9wdGltaXplci8uL3NyYy9saWIvb3B0aW1pemVyLnRzIiwid2VicGFjazovL3Bob3B0aW1pemVyLy4vc3JjL2xpYi91bmNhdWdodC1oYW5kbGVyLnRzIiwid2VicGFjazovL3Bob3B0aW1pemVyLy4vc3JjL21haW4udHMiLCJ3ZWJwYWNrOi8vcGhvcHRpbWl6ZXIvZXh0ZXJuYWwgY29tbW9uanMgXCJhcmdwYXJzZVwiIiwid2VicGFjazovL3Bob3B0aW1pemVyL2V4dGVybmFsIGNvbW1vbmpzIFwiamltcFwiIiwid2VicGFjazovL3Bob3B0aW1pemVyL2V4dGVybmFsIG5vZGUtY29tbW9uanMgXCJmc1wiIiwid2VicGFjazovL3Bob3B0aW1pemVyL2V4dGVybmFsIG5vZGUtY29tbW9uanMgXCJyZWFkbGluZVwiIiwid2VicGFjazovL3Bob3B0aW1pemVyL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3Bob3B0aW1pemVyL3dlYnBhY2svc3RhcnR1cCJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgY29sb3JlZCA9IChcbiAgbWVzc2FnZTogc3RyaW5nLFxuICB0eXBlOiBcImluZm9cIiB8IFwiZXJyb3JcIiB8IFwic3VjY2Vzc1wiID0gXCJpbmZvXCJcbik6IHN0cmluZyA9PiB7XG4gIGNvbnN0IGNvbG9ycyA9IHtcbiAgICBpbmZvOiBcIlxceDFiWzM2bVwiLFxuICAgIGVycm9yOiBcIlxceDFiWzMxbVwiLFxuICAgIHN1Y2Nlc3M6IFwiXFx4MWJbMzJtXCIsXG4gIH07XG5cbiAgcmV0dXJuIGAke2NvbG9yc1t0eXBlXX0ke21lc3NhZ2V9XFx4MWJbMG1gO1xufTtcbiIsImV4cG9ydCAqIGZyb20gXCIuL2NvbG9yZWRcIjtcbmV4cG9ydCAqIGZyb20gXCIuL29wdGltaXplclwiO1xuZXhwb3J0ICogZnJvbSBcIi4vdW5jYXVnaHQtaGFuZGxlclwiO1xuIiwiaW1wb3J0IHsgQVVUTywgcmVhZCB9IGZyb20gXCJqaW1wXCI7XG5cbmV4cG9ydCBjb25zdCBvcHRpbWl6ZXIgPSBhc3luYyAoXG4gIHBhdGg6IHN0cmluZyxcbiAgaW1hZ2VOYW1lOiBzdHJpbmcsXG4gIG92ZXJ3cml0ZTogYm9vbGVhbixcbiAgd2lkdGg6IG51bWJlcixcbiAgaGVpZ2h0ID0gQVVUTyxcbiAgcXVhbGl0eSA9IDgwXG4pID0+IHtcbiAgY29uc3QgaW1hZ2VQYXRoID0gYCR7cGF0aH1cXFxcJHtpbWFnZU5hbWV9YDtcbiAgY29uc3QgaW1hZ2UgPSBhd2FpdCByZWFkKGltYWdlUGF0aCk7XG5cbiAgYXdhaXQgaW1hZ2UuY29udGFpbih3aWR0aCwgaGVpZ2h0KTtcbiAgYXdhaXQgaW1hZ2UucXVhbGl0eShxdWFsaXR5KTtcblxuICBpZiAob3ZlcndyaXRlKSB7XG4gICAgYXdhaXQgaW1hZ2Uud3JpdGVBc3luYyhpbWFnZVBhdGgpO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IGltYWdlTmFtZVNwbGl0dGVkID0gaW1hZ2VOYW1lLnNwbGl0KFwiLlwiKTtcbiAgICBjb25zdCBpbWFnZU5hbWVXaXRob3V0RXh0ZW5zaW9uID0gaW1hZ2VOYW1lU3BsaXR0ZWRcbiAgICAgIC5zbGljZSgwLCBpbWFnZU5hbWVTcGxpdHRlZC5sZW5ndGggLSAxKVxuICAgICAgLmpvaW4oXCIuXCIpO1xuICAgIGNvbnN0IGltYWdlRXh0ZW5zaW9uID0gaW1hZ2VOYW1lU3BsaXR0ZWRbaW1hZ2VOYW1lU3BsaXR0ZWQubGVuZ3RoIC0gMV07XG5cbiAgICBhd2FpdCBpbWFnZS53cml0ZUFzeW5jKFxuICAgICAgYCR7cGF0aH1cXFxcJHtpbWFnZU5hbWVXaXRob3V0RXh0ZW5zaW9ufS1vcHRpbWl6ZWQuJHtpbWFnZUV4dGVuc2lvbn1gXG4gICAgKTtcbiAgfVxufTtcbiIsImltcG9ydCB7IGNvbG9yZWQgfSBmcm9tIFwiLi9jb2xvcmVkXCI7XG5cbnByb2Nlc3Mub24oXCJ1bmNhdWdodEV4Y2VwdGlvblwiLCAoZXJyLCByZWFzb24pID0+IHtcbiAgY29uc29sZS5sb2coY29sb3JlZChlcnIubWVzc2FnZSwgXCJlcnJvclwiKSk7XG4gIGNvbnNvbGUubG9nKGNvbG9yZWQocmVhc29uLCBcImVycm9yXCIpKTtcbn0pO1xuIiwiaW1wb3J0IFwiLi9saWIvdW5jYXVnaHQtaGFuZGxlclwiO1xuaW1wb3J0IHsgQVVUTyB9IGZyb20gXCJqaW1wXCI7XG5pbXBvcnQgeyBBcmd1bWVudFBhcnNlciB9IGZyb20gXCJhcmdwYXJzZVwiO1xuaW1wb3J0IHsgY3JlYXRlSW50ZXJmYWNlIH0gZnJvbSBcInJlYWRsaW5lXCI7XG5pbXBvcnQgKiBhcyBmcyBmcm9tIFwiZnNcIjtcbmltcG9ydCB7IGNvbG9yZWQsIG9wdGltaXplciB9IGZyb20gXCIuL2xpYlwiO1xuXG5jb25zdCBwYXJzZXIgPSBuZXcgQXJndW1lbnRQYXJzZXIoe1xuICBkZXNjcmlwdGlvbjogXCJQaG9wdGltaXphdG9yIGlzIGEgc2ltcGxlIGltYWdlIG9wdGltaXphdG9yIGZyb20gLWNsaS5cIixcbn0pO1xuXG5jb25zdCBjbGkgPSBjcmVhdGVJbnRlcmZhY2Uoe1xuICBpbnB1dDogcHJvY2Vzcy5zdGRpbixcbiAgb3V0cHV0OiBwcm9jZXNzLnN0ZG91dCxcbn0pO1xuXG5jb25zdCBTVVBQT1JURURfVFlQRVMgPSBbXCJqcGdcIiwgXCJqcGVnXCIsIFwicG5nXCIsIFwidGlmXCIsIFwiZ2lmXCIsIFwiYm1wXCJdO1xuXG5wYXJzZXIuYWRkX2FyZ3VtZW50KFwiLXZcIiwgXCItLXZlcnNpb25cIiwge1xuICBhY3Rpb246IFwidmVyc2lvblwiLFxuICB2ZXJzaW9uOiByZXF1aXJlKFwiLi8uLi9wYWNrYWdlLmpzb25cIikudmVyc2lvbixcbn0pO1xucGFyc2VyLmFkZF9hcmd1bWVudChcIi1mXCIsIFwiLS1maWxlXCIsIHtcbiAgaGVscDogXCJJbWFnZSBuYW1lIG9uIGN1cnJlbnQgcGF0aC4gRXhhbXBsZTogeHh4LmpwZ1wiLFxuICBkZWZhdWx0OiBcIkFMTFwiLFxufSk7XG5wYXJzZXIuYWRkX2FyZ3VtZW50KFwiLXBcIiwgXCItLXBhdGhcIiwge1xuICBoZWxwOiBcIkltYWdlIHBhdGggZGVzdGluYXRpb24uIERlZmF1bHQ6IHByb2Nlc3MuY3dkKClcIixcbiAgZGVmYXVsdDogcHJvY2Vzcy5jd2QoKSxcbn0pO1xucGFyc2VyLmFkZF9hcmd1bWVudChcIi1xXCIsIFwiLS1xdWFsaXR5XCIsIHtcbiAgaGVscDogXCJJbWFnZSBxdWFsaXR5LiBEZWZhdWx0OiA3MFwiLFxuICBkZWZhdWx0OiA3MCxcbn0pO1xucGFyc2VyLmFkZF9hcmd1bWVudChcIi1oZVwiLCBcIi0taGVpZ2h0XCIsIHtcbiAgaGVscDogXCJJbWFnZSBoZWlnaHQuIERlZmF1bHQ6IEFVVE9cIixcbiAgZGVmYXVsdDogQVVUTyxcbn0pO1xucGFyc2VyLmFkZF9hcmd1bWVudChcIi13XCIsIFwiLS13aWR0aFwiLCB7XG4gIGhlbHA6IFwiSW1hZ2Ugd2lkdGguIERlZmF1bHQ6IDE5MjBcIixcbiAgZGVmYXVsdDogMTkyMCxcbn0pO1xucGFyc2VyLmFkZF9hcmd1bWVudChcIi1vXCIsIFwiLS1vdmVyd3JpdGVcIiwge1xuICBoZWxwOiBcIk92ZXJ3cml0ZS4gSWYgeW91IHNldCB0aGlzIG9wdGlvbiwgb3B0aW1pemVkIGltYWdlIG92ZXJ3cml0ZXMgb3JpZ2luYWwgZmlsZSB3aXRoIHNhbWUgbmFtZS5cIixcbiAgZGVmYXVsdDogZmFsc2UsXG59KTtcblxuY29uc3Qgb3B0aW9ucyA9IHBhcnNlci5wYXJzZV9hcmdzKCk7XG5cbihhc3luYyAoKSA9PiB7XG4gIGNvbnN0IHF1ZXN0aW9uU3RyaW5nID1cbiAgICBPYmplY3Qua2V5cyhvcHRpb25zKS5yZWR1Y2UoKGFjYywga2V5KSA9PiB7XG4gICAgICByZXR1cm4gYWNjICsgYCR7a2V5fTogJHtvcHRpb25zW2tleV19YCArIFwiXFxuXCI7XG4gICAgfSwgYE9wdGlvbnM6IFxcbmApICsgYFxcbkFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBjb250aW51ZT8gKHkvbilgO1xuXG4gIGNsaS5xdWVzdGlvbihxdWVzdGlvblN0cmluZywgYXN5bmMgKGFuc3dlcikgPT4ge1xuICAgIGlmIChhbnN3ZXIudG9Mb3dlckNhc2UoKSA9PT0gXCJ5XCIpIHtcbiAgICAgIGxldCBvcHRpbWl6ZUZpbGVzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgICBpZiAob3B0aW9ucy5maWxlID09PSBcIkFMTFwiKSB7XG4gICAgICAgIGNvbnN0IGZpbGVzID0gYXdhaXQgZnMucHJvbWlzZXMucmVhZGRpcihvcHRpb25zLnBhdGgpO1xuXG4gICAgICAgIG9wdGltaXplRmlsZXMgPSBmaWxlcy5maWx0ZXIoKGZpbGUpID0+IHtcbiAgICAgICAgICBjb25zdCBzcGxpdHRlZEZpbGUgPSBmaWxlLnNwbGl0KFwiLlwiKTtcbiAgICAgICAgICBjb25zdCBleHRlbnNpb24gPSBzcGxpdHRlZEZpbGVbc3BsaXR0ZWRGaWxlLmxlbmd0aCAtIDFdO1xuXG4gICAgICAgICAgcmV0dXJuIFNVUFBPUlRFRF9UWVBFUy5pbmNsdWRlcyhleHRlbnNpb24pO1xuICAgICAgICB9KTtcblxuICAgICAgICBjb25zb2xlLmxvZyhvcHRpbWl6ZUZpbGVzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG9wdGltaXplRmlsZXMucHVzaChvcHRpb25zLmZpbGUpO1xuICAgICAgfVxuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG9wdGltaXplRmlsZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgZmlsZSA9IG9wdGltaXplRmlsZXNbaV07XG4gICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgIGNvbG9yZWQoXG4gICAgICAgICAgICBgT3B0aW1pemluZyAke2ZpbGV9Li4uIFske2kgKyAxfS8ke29wdGltaXplRmlsZXMubGVuZ3RofV1gLFxuICAgICAgICAgICAgXCJpbmZvXCJcbiAgICAgICAgICApXG4gICAgICAgICk7XG5cbiAgICAgICAgYXdhaXQgb3B0aW1pemVyKFxuICAgICAgICAgIG9wdGlvbnMucGF0aCxcbiAgICAgICAgICBmaWxlLFxuICAgICAgICAgIG9wdGlvbnMub3ZlcndyaXRlLFxuICAgICAgICAgIG9wdGlvbnMud2lkdGgsXG4gICAgICAgICAgb3B0aW9ucy5oZWlnaHQsXG4gICAgICAgICAgb3B0aW9ucy5xdWFsaXR5XG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKGNvbG9yZWQoXCJPcHRpbWl6YXRpb24gY29tcGxldGVkIVwiLCBcInN1Y2Nlc3NcIikpO1xuICAgICAgcHJvY2Vzcy5leGl0KDUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZyhjb2xvcmVkKFwiT3B0aW1pemF0aW9uIGNhbmNlbGVkIVwiLCBcImVycm9yXCIpKTtcbiAgICAgIHByb2Nlc3MuZXhpdCgxMyk7XG4gICAgfVxuICB9KTtcbn0pKCk7XG4iLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJhcmdwYXJzZVwiKTsiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJqaW1wXCIpOyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImZzXCIpOyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInJlYWRsaW5lXCIpOyIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8vIFRoaXMgZW50cnkgbW9kdWxlIGlzIHJlZmVyZW5jZWQgYnkgb3RoZXIgbW9kdWxlcyBzbyBpdCBjYW4ndCBiZSBpbmxpbmVkXG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oNTE5KTtcbiJdLCJuYW1lcyI6WyJjb2xvcmVkIiwibWVzc2FnZSIsInR5cGUiLCJpbmZvIiwiZXJyb3IiLCJzdWNjZXNzIiwib3B0aW1pemVyIiwicGF0aCIsImltYWdlTmFtZSIsIm92ZXJ3cml0ZSIsIndpZHRoIiwiaGVpZ2h0IiwiQVVUTyIsInF1YWxpdHkiLCJpbWFnZVBhdGgiLCJpbWFnZSIsInJlYWQiLCJjb250YWluIiwid3JpdGVBc3luYyIsImltYWdlTmFtZVNwbGl0dGVkIiwic3BsaXQiLCJpbWFnZU5hbWVXaXRob3V0RXh0ZW5zaW9uIiwic2xpY2UiLCJsZW5ndGgiLCJqb2luIiwiaW1hZ2VFeHRlbnNpb24iLCJwcm9jZXNzIiwib24iLCJlcnIiLCJyZWFzb24iLCJjb25zb2xlIiwibG9nIiwicGFyc2VyIiwiQXJndW1lbnRQYXJzZXIiLCJkZXNjcmlwdGlvbiIsImNsaSIsImNyZWF0ZUludGVyZmFjZSIsImlucHV0Iiwic3RkaW4iLCJvdXRwdXQiLCJzdGRvdXQiLCJTVVBQT1JURURfVFlQRVMiLCJhZGRfYXJndW1lbnQiLCJhY3Rpb24iLCJ2ZXJzaW9uIiwiaGVscCIsImRlZmF1bHQiLCJjd2QiLCJvcHRpb25zIiwicGFyc2VfYXJncyIsInF1ZXN0aW9uU3RyaW5nIiwiT2JqZWN0Iiwia2V5cyIsInJlZHVjZSIsImFjYyIsImtleSIsInF1ZXN0aW9uIiwiYW5zd2VyIiwidG9Mb3dlckNhc2UiLCJvcHRpbWl6ZUZpbGVzIiwiZmlsZSIsImZzIiwicHJvbWlzZXMiLCJyZWFkZGlyIiwiZmlsdGVyIiwic3BsaXR0ZWRGaWxlIiwiZXh0ZW5zaW9uIiwiaW5jbHVkZXMiLCJwdXNoIiwiaSIsImV4aXQiLCJtb2R1bGUiLCJleHBvcnRzIiwicmVxdWlyZSIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsInVuZGVmaW5lZCIsIl9fd2VicGFja19tb2R1bGVzX18iLCJjYWxsIl0sInNvdXJjZVJvb3QiOiIifQ==